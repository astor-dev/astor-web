---
import Layout from "~layouts/BaseLayout.astro";
import BlogPostCard from "~components/Card/BlogPostCard";
import SeriesCard from "~components/Card/SeriesCard";
import Tag from "~components/Tag/Tag";
import { getPosts, getAllTags, getAllSeries } from "~utils/getPosts";
import FullImageBlogPostCard from "~components/Card/FullImageBlogPostCard";
import SeriesScrollSection from "~components/Section/SeriesScrollSection";
import BlogPostListItem from "~components/List/BlogPostListItem";
// íƒœê·¸ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
const tags = await getAllTags();

// ê³ ì • í¬ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸°
const pinnedPosts = await getPosts({ 
  filter: { 
    pinned: true,
    draft: false 
  },
  sort: { 
    by: "createdAt", 
    order: "desc" 
  }
});

// ì¼ë°˜ í¬ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸°
const regularPosts = await getPosts({ 
  filter: { 
    draft: false 
  },
  sort: { 
    by: "createdAt", 
    order: "desc" 
  },
  paging:{
    page: 1,
    limit: 5
  }
});

// ì‹œë¦¬ì¦ˆ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
const series = await getAllSeries();

---
<Layout title="ë¸”ë¡œê·¸">
  <article class="mx-auto w-full">

    {/* íƒœê·¸ í•„í„° ì„¹ì…˜ */}
    <div class="mb-8 overflow-x-auto">
      <div class="flex gap-2 pb-4">
        {tags.map(({ tag, count }) => (
          <Tag 
            text={tag} 
            count={count} 
            size="md" 
            client:load
          />
        ))}
      </div>
    </div>


    <SeriesScrollSection series={series} client:load/>


    {/* ìµœê·¼ í¬ìŠ¤íŠ¸ ì„¹ì…˜ */}
    <section class="mb-12">
      <h2 class="mb-6 text-2xl font-bold text-black-accent">ìµœê·¼ í¬ìŠ¤íŠ¸</h2>
      
      <div class="divide-y divide-gray-100">
        {regularPosts.map((post) => (
          <BlogPostListItem 
            {...post} 
            client:load 
          />
        ))}
      </div>
    </section>

    <!-- {/* ê³ ì •ëœ í¬ìŠ¤íŠ¸ ì„¹ì…˜ - ëª¨ë˜ ì¹´ë“œ ì‚¬ìš© */}
    {pinnedPosts.length > 0 && (
      <section class="mb-12">
        <h2 class="mb-6 text-2xl font-bold text-black-accent">ğŸ“Œ ì£¼ìš” í¬ìŠ¤íŠ¸</h2>
        <div class="grid gap-6 sm:grid-cols-2">
          {pinnedPosts.map(post => (
            <BlogPostCard {...post} client:load />
          ))}
        </div>
      </section>
    )} -->

  </article>
</Layout>

