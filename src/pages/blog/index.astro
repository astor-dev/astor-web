---
import Layout from "~layouts/BaseLayout.astro";
import BlogPostCard from "~components/Card/BlogPostCard";
import SeriesCard from "~components/Card/SeriesCard";
import Tag from "~components/Tag/Tag";
import { getPosts, getAllTags, getAllSeries } from "~utils/getPosts";
import FullImageBlogPostCard from "~components/Card/FullImageBlogPostCard";
import BlogPostListItem from "~components/List/BlogPostListItem";
import { FaArrowRight } from "react-icons/fa";
import TagCard from "~components/Card/TagCard";
import { FullImageSeriesCard } from "~components/Card/FullImageSeriesCard";
import { PiShootingStarFill } from "react-icons/pi";
// íƒœê·¸ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
const tags = await getAllTags();

// ê³ ì • í¬ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸°
// const pinnedPosts = await getPosts({ 
//   filter: { 
//     pinned: true,
//     draft: false 
//   },
//   sort: { 
//     by: "createdAt", 
//     order: "desc" 
//   }
// });

// ì¼ë°˜ í¬ìŠ¤íŠ¸ ê°€ì ¸ì˜¤ê¸°
const regularPosts = await getPosts({ 
  filter: { 
    draft: false 
  },
  sort: { 
    by: "createdAt", 
    order: "desc" 
  },
  paging:{
    page: 1,
    limit: 5
  }
});

// ì‹œë¦¬ì¦ˆ ì •ë³´ ê°€ì ¸ì˜¤ê¸°
const series = await getAllSeries();

---
<Layout title="ë¸”ë¡œê·¸">
  <article class="mx-auto w-full mt-16">
    {/* ì¸ê¸° íƒœê·¸ ì„¹ì…˜ */}
    <section class="mb-12">
      <div class="mb-8">
        <h2 class="text-2xl font-bold text-black-accent">ì¸ê¸° íƒœê·¸</h2>
        <p class="mt-1 text-black-muted">ìì£¼ ë‹¤ë£¨ëŠ” ì£¼ì œë“¤ì´ì—ìš”</p>
      </div>
      
      <div class="grid grid-cols-2 gap-4 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-6">
        {tags
          .sort((a, b) => b.count - a.count)
          .slice(0, 12)
          .map((tag, index) => (
            <TagCard {...tag} index={index}  client:load />
          ))}
      </div>
    </section>
   

    {/* ìµœê·¼ í¬ìŠ¤íŠ¸ ì„¹ì…˜ */}
    <section class="mb-12">
      <div class="mb-8">
        <h2 class="text-2xl font-bold text-black-accent">ìµœê·¼ í¬ìŠ¤íŠ¸</h2>
        <p class="mt-1 text-black-muted">ìµœê·¼ ì—…ë°ì´íŠ¸ëœ í¬ìŠ¤íŠ¸ë“¤ì´ì—ìš”</p>
      </div>
      
      <div class="divide-y divide-gray-100">
        {regularPosts.map((post) => (
          <BlogPostListItem 
            {...post} 
            client:load 
          />
        ))}
      </div>
    </section>

    <!-- ì‹œë¦¬ì¦ˆ ì„¹ì…˜ -->
    <section class="mb-16">
      <div class="mb-8">
        <h2 class="text-2xl font-bold text-black-accent">ì‹œë¦¬ì¦ˆ</h2>
        <p class="mt-1 text-black-muted">ì—°ì¬ ì¤‘ì¸ ì‹œë¦¬ì¦ˆë“¤ì´ì—ìš”</p>
      </div>

      <div class="grid auto-rows-fr gap-6 sm:grid-cols-2 lg:grid-cols-3">
        {series.slice(0, 3).map((seriesData) => (
          <FullImageSeriesCard {...seriesData} client:load />
        ))}
      </div>
    </section>

    <!-- {/* ê³ ì •ëœ í¬ìŠ¤íŠ¸ ì„¹ì…˜ - ëª¨ë˜ ì¹´ë“œ ì‚¬ìš© */}
    {pinnedPosts.length > 0 && (
      <section class="mb-12">
        <h2 class="mb-6 text-2xl font-bold text-black-accent">ğŸ“Œ ì£¼ìš” í¬ìŠ¤íŠ¸</h2>
        <div class="grid gap-6 sm:grid-cols-2">
          {pinnedPosts.map(post => (
            <BlogPostCard {...post} client:load />
          ))}
        </div>
      </section>
    )} -->

  </article>
</Layout>

